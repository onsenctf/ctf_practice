# seesaw

## 脆弱性

素数 `q` のビット長が 16 と短すぎる点

## 解答

chall.py の8行目を見ると、RSA暗号の秘密鍵 `q` は16ビット素数である :

```py
q = getPrime(16)
```

これより `n` は瞬時に素因数分解できるため秘密鍵 `p` `q` が求まる。 `p` `q` を用いて暗号文 `c` を復号しフラグを得る。

```py
from sage.all_cmdline import *

n = 362433315617467211669633373003829486226172411166482563442958886158019905839570405964630640284863309204026062750823707471292828663974783556794504696138513859209
c = 104442881094680864129296583260490252400922571545171796349604339308085282733910615781378379107333719109188819881987696111496081779901973854697078360545565962079

factors = factor(n)
p = factors[0][0]
q = factors[1][0]

print(long_to_bytes(pow(c, pow(65537, -1, (p-1)*(q-1)), n)).decode())
```

```
ctf4b{unb4l4nc3d_pr1m35_4r3_b4d}
```
